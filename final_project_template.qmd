---
title: "Investigating the Association Between Maternal Folic Acid Supplementation During Pregnancy and the Risk of Low Birth Weight"
subtitle: "BMIN503/EPID600 Final Project"
author: "Michaela Olabisi"
format: html
editor: visual
number-sections: true
embed-resources: true
---

------------------------------------------------------------------------

## Overview {#sec-overview}

This study examines the link between maternal folic acid supplementation before and during pregnancy and the risk of delivering a low birth weight (LBW) infant, defined as a birth weight below 2,500 grams.^1^ LBW is associated with higher neonatal morbidity and long-term health issues. Folic acid, vital for fetal development, may help prevent LBW by supporting placental health. Using data from the Pregnancy Risk Assessment Monitoring System (PRAMS), Phase 8, the study finds that folic acid supplementation during pregnancy appears to reduce LBW risk, while pre-pregnancy intake may slightly increase it. Socioeconomic factors, such as education and income, as well as race and prenatal care, also play significant roles in LBW outcomes. The study highlights the need for targeted interventions addressing these factors to reduce LBW rates. I consulted with Dr. John Holmes and Dr. Ellen Caniglia from the Department of Biostatistics, Epidemiology & Informatics. Dr. Holmes highlighted potential study limitations, such as selection bias, while Dr. Caniglia shared a relevant [paper](https://pubmed.ncbi.nlm.nih.gov/35561720/) that examines the link between supplementation and adverse pregnancy outcomes like preterm birth (PTB) and LBW. You can access the final project, including all code and results, on my GitHub: <https://github.com/msaolabisi/BMIN503_Final_Project.git>

## Introduction {#sec-introduction}

The problem I'm addressing in this project is the potential link between maternal folic acid supplementation before and during pregnancy and the risk of delivering a LBW infant, defined as a birth weight under 2,500 grams. LBW is an important indicator of adverse pregnancy outcomes, including higher rates of neonatal morbidity, mortality, and long-term developmental issues like cardiovascular and metabolic disorders.^2^ These conditions put a lot of stress on healthcare systems, driving up costs and the need for more intensive care, including extended stays in the NICU (Neonatal Intensive Care Unit).^3^ It's important to identify maternal factors that can be changed to lower the risk of LBW, as this could help improve the health of both mothers and babies.

Folic acid is a B vitamin that’s often recommended during pregnancy to help prevent birth defects like spina bifida.^4^ It helps with DNA production, cell growth, and tissue development, which are all crucial for the rapid development of the fetus.^5^ Folic acid may also support the placenta, which provides the fetus with nutrients and oxygen, and a healthy placenta can help prevent LBW.^5^ By reducing these issues, folic acid might help lower the chances of having an LBW baby.

Despite these potential benefits, the direct relationship between folic acid and LBW isn’t fully established, and the research results are inconsistent. This is why it’s important to further investigate how folic acid supplementation before and during pregnancy might affect LBW.

This issue spans multiple fields. Epidemiology helps us understand the patterns and causes of LBW, while biostatistics is used to analyze large datasets like PRAMS. Public health looks at how factors like folic acid impact maternal and fetal health at the population level. Nutrition explains the role of folic acid in fetal development, and obstetrics and maternal health offer insights into how maternal health, prenatal care, and pregnancy complications influence birth weight outcomes.

When I spoke with Dr. John Holmes and Dr. Ellen Caniglia from the Department of Biostatistics, Epidemiology & Informatics, they helped me better understand the challenges of studying this issue. Dr. Holmes stressed the importance of addressing biases, like selection bias, when interpreting data in this case and Dr. Caniglia shared her research on supplementation and pregnancy outcomes, providing valuable context for studying the link between folic acid and LBW.

By drawing from these different fields of expertise, this project seeks to clarify the potential role of folic acid supplementation in reducing LBW.

## Methods {#sec-methods}

This study is a secondary analysis of data collected from the Phase 8 (2016–2022) Pregnancy Risk Assessment Monitoring System (PRAMS), a population-based surveillance system that collects data on maternal attitudes, behaviors, and experiences before, during, and after pregnancy conducted by the Centers for Disease Control and Prevention (CDC) in collaboration with state health departments. The dataset included responses from 249,970 women across all U.S. states who gave birth within the study period.

The PRAMS survey included a core set of questions and optional standard questions tailored to state-specific needs. For this study, the primary exposure variables were folic acid supplementation before and during pregnancy, both categorized as "Yes" or "No." The primary outcome was infant birth weight, categorized as "Yes Low Birth Weight" or "No Low Birth Weight" Covariates included maternal age, race/ethnicity, education, smoking during pregnancy, pre-pregnancy BMI, prenatal care utilization, state, and income.

Descriptive statistics were used to summarize maternal and infant characteristics, stratified by LBW status, and analyzed using t-tests for continuous variables and chi-square tests for categorical variables. Univariate and multivariate logistic regression models were employed to estimate unadjusted and adjusted odds ratios (ORs) for the relationship between folic acid intake (before and during pregnancy) and LBW. Additional tables and figures included 2x2 tables to assess the relationship between exposures and outcome, bar plots displaying the relationship between exposures, covariates, and LBW, and a dot plot showing LBW counts/rates across states. A forest plot was also generated to display both adjusted and unadjusted odds ratios (ORs) for the association between folic acid intake (before and during pregnancy) and LBW.

## Install, Read, & Load Packages {#sec-install-read-&-load-packages}

```{r}
options(repos = c(CRAN = "https://cloud.r-project.org")) 

##install packages
install.packages("haven")
install.packages("tableone")
install.packages("viridis")
install.packages("sf")
install.packages("maps")
install.packages("gt")

##load packages
library(gt)
library(haven)
library(dplyr)
library(tidyr)
library(ggplot2)
library(caret)
library(boot)
library(tableone)
library(broom)
library(viridis)
library(sf)
library(maps)
```

```{r}

# read a .sas7bdat file
data <- read_sas("/Users/molabisi/Downloads/PRAMS ARF/phase8_arf_2016_2022.sas7bdat")

# view the first few rows of the data
head(data)

```

## Cleaning Data {#sec-cleaning-data}

```{r}
## count/how many people in data set
cat("Total rows in the dataset:", nrow(data), "\n")

##cleaning data
data_clean <- data %>%
##recoding exposure variables
  mutate(
     # For PRE_VIT_RAW (pre preg -- PPV -- folic acid)
    PRE_VIT_RAW = case_when(
      PRE_VIT_RAW == 1 ~ 0,   # NO -> 0
      PRE_VIT_RAW == 2 ~ 1,   # YES -> 1
      TRUE ~ NA_real_ # Keep other values unchanged
    ),
    # For VPP_VIT_RAW (during preg -- PPV -- folic acid)
    VPP_VIT_RAW = case_when(
      VPP_VIT_RAW == 1 ~ 0,   # NO -> 0
      VPP_VIT_RAW == 2 ~ 1,   # YES -> 1
      TRUE ~ NA_real_ # Keep other values unchanged
    ),
    
    # Convert to factors after recoding
    PRE_VIT_RAW = factor(PRE_VIT_RAW, levels = c(0, 1)),
    VPP_VIT_RAW = factor(VPP_VIT_RAW, levels = c(0, 1))
  )

## recoding outcome variables 4 categories
data_clean <- data_clean %>%
  mutate(
  GRAM_NAPHSIS = case_when(
    GRAM_NAPHSIS < 1500 ~ 0,       # VLBW: Less than 1500 grams
    GRAM_NAPHSIS >= 1500 & GRAM_NAPHSIS < 2500 ~ 1, # LBW: 1500-2499 grams
    GRAM_NAPHSIS >= 2500 & GRAM_NAPHSIS <= 4000 ~ 2, # NBW: 2500-4000 grams
    GRAM_NAPHSIS > 4000 ~ 3,       # Macrosomia: Over 4000 grams
    TRUE ~ NA_real_                # Missing or invalid data
  ),
  GRAM_NAPHSIS = factor(GRAM_NAPHSIS, levels = c(0, 1, 2, 3)),

## recoding outcome variable dichotomous
 LBW = case_when(
      GRAM_NAPHSIS == 0 | GRAM_NAPHSIS == 1 ~ 1,  # VLBW or LBW
      GRAM_NAPHSIS == 2 | GRAM_NAPHSIS == 3 ~ 0,   # NBW or Macrosomia
      TRUE ~ NA_real_ # Missing or invalid data
    ),
LBW = factor(LBW, levels = c(0, 1)),
  )
table(data_clean$PRE_VIT_RAW)
table(data_clean$VPP_VIT_RAW)
table(data_clean$GRAM_NAPHSIS)
table(data_clean$LBW)
```

```{r}
## cleaning data
data_clean <- data_clean %>%
##cleaning covariates
  mutate(
    # Maternal Age
    MAT_AGE_PU = as.numeric(MAT_AGE_PU),
    
    # Parity
    PRE_LB_NAPHSIS = case_when(
      PRE_LB_NAPHSIS == 0 ~ 0,       # No children (0)
      PRE_LB_NAPHSIS == 1 ~ 1,       # One child (1)
      PRE_LB_NAPHSIS %in% c(2, 3, 4) ~ 2, # 2+ children (Yes, multiple)
      TRUE ~ NA_real_
    ),
    PRE_LB_NAPHSIS = as.factor(PRE_LB_NAPHSIS),
    
    # BMI 
    MOM_BMI = as.numeric(MOM_BMI),
    
   # Education
    MAT_ED = case_when(
      MAT_ED %in% c(1, 2) ~ "<= 12th grade, no diploma", 
      MAT_ED == 3 ~ "High school graduate / GED",  
      MAT_ED == 4 ~ "Some college, no degree",  
      MAT_ED == 5 ~ "Bachelor's, Master's, or higher",  
      TRUE ~ NA_character_
    ),
    MAT_ED = as.factor(MAT_ED),
   
    # Income
  INCOME8 = case_when(
  INCOME8 %in% c(1, 2, 3, 4, 5, 6, 13, 14, 101, 102, 103, 104, 105) ~ "Low income (0 - $40,000)",  
  INCOME8 %in% c(7, 8, 9, 10, 11, 106, 107, 108, 109) ~ "Middle ($40,001 - $85,000)",
  INCOME8 %in% c(12, 15, 16, 17, 18, 19, 20, 21, 22, 110, 111, 112) ~ "High income ($85,001 or more)",  
  TRUE ~ NA_character_
),
  INCOME8 = as.factor(INCOME8),

  STATE = as.factor(STATE), 

  PNC_VST = as.factor(PNC_VST),

  MAT_RACE_PU = case_when(
    MAT_RACE_PU == 2 ~ "White",
    MAT_RACE_PU == 3 ~ "Black",
    MAT_RACE_PU == 4 ~ "American Indian",
    MAT_RACE_PU == 10 ~ "Alaska Native",
    MAT_RACE_PU == 21 ~ "Asian",
    MAT_RACE_PU == 22 ~ "Hawaiian/Other Pacific Islander",
    MAT_RACE_PU == 23 ~ "Other/Multiple Race",
    TRUE ~ NA_character_
  ),
  MAT_RACE_PU = as.factor(MAT_RACE_PU)
  )

table(data_clean$PRE_VIT_RAW)
table(data_clean$VPP_VIT_RAW)
table(data_clean$GRAM_NAPHSIS)
table(data_clean$MAT_AGE_PU)
table(data_clean$PRE_LB_NAPHSIS)
table(data_clean$MOM_BMI)
table(data_clean$MAT_ED)
table(data_clean$STATE)
table(data_clean$INCOME8)
table(data_clean$PNC_VST)
table(data_clean$MAT_RACE_PU)
```

## Results {#sec-results}

## Descriptive Statistics {#sec-descriptive-statistics}

```{r}
#specifying continuous and categorical variables
# List of continuous variables
cont_vars <- c("MAT_AGE_PU", "MOM_BMI")

# List of categorical variables
cat_vars <- c("PRE_VIT_RAW", "VPP_VIT_RAW", "GRAM_NAPHSIS", "LBW", "PRE_LB_NAPHSIS", "MAT_ED", "STATE", "INCOME8", "PNC_VST", "MAT_RACE_PU")
```

### Descriptive Table - ALL {#sec-descriptive-statistics-ALL}

```{r}
# descriptive tables
table1 <- CreateTableOne(vars = c(cont_vars, cat_vars), data = data_clean)
print(table1, showAllLevels = TRUE)
#summary(table1, showAllLevels = TRUE)
```

The sample consists mostly of low-income, white women, with about 36% reporting pre-pregnancy folic intake and about 56% reporting pregnancy folic intake. The population had an average count of prenatal care visits. The population had a higher BMI, were around the average age to have a baby, most were nulliparous, with about 1/5 having a low birth weight baby. Most participants have completed higher education. Massachusetts and Michigan are the most represented out of the states in the population.

### Descriptive Table - vlbw, lbw, nbw, mac {#sec-descriptive-statistics-vlbw-lbw-nbw-mac}

```{r}
#specifying continuous and categorical variables
# List of continuous variables
cont_vars1 <- c("MAT_AGE_PU", "MOM_BMI")

# List of categorical variables
cat_vars1 <- c("PRE_VIT_RAW", "VPP_VIT_RAW", "PRE_LB_NAPHSIS", "MAT_ED", "STATE", "INCOME8", "PNC_VST", "MAT_RACE_PU")
```

```{r}
## cleaning data
data_clean_filtered <- data_clean %>%
  filter(complete.cases(select(., c(cont_vars1, cat_vars1))))

# Variables to include in the descriptive table - lbw, vlbw, nbw, mac
# Create stratified descriptive table
table2 <- CreateTableOne(vars = c(cont_vars1, cat_vars1), strata = "GRAM_NAPHSIS", data = data_clean)
print(table2, showAllLevels = TRUE)
# summary(table2)
```

There is a significant difference in maternal age, BMI, pre-pregnancy folic intake, pregnancy folic intake, parity, maternal education, state, income, prenatal care visit count, and race between the different categories of birth weight (very low birth weight, low birth weight, normal birth weight, and macrasomia).

### Descriptive Table - yes lbw, no lbw {#sec-descriptive-statistics-yes-lbw-no-lbw}

```{r}

# Variables to include in the descriptive table - lbw, not lbw
# Create stratified descriptive table
table3 <- CreateTableOne(vars = c(cont_vars1, cat_vars1), strata = "LBW", data = data_clean)
print(table3, showAllLevels = TRUE)
#summary(table3)
```

There is a significant difference in pre-pregnancy folic intake, pregnancy folic intake, parity, maternal education, state, income, prenatal care visit count, and race between low birth weight.

## 2x2 Tables {#sec-2x2-table}

```{r}
# 2x2 tables
addmargins(table(data_clean$PRE_VIT_RAW, data_clean$LBW,
                 dnn = c("Pre-pregnancy Folic Intake",
                         "LBW")))

addmargins(table(data_clean$VPP_VIT_RAW, data_clean$LBW,
                 dnn = c("Pre-pregnancy Folic Intake",
                         "LBW")))

```

For Pre-pregnancy- 86960 individuals who did not have low birth weight and did not have pre-pregnancy folic intake. 23368 individuals who had low birth weight and did not have pre-pregnancy folic intake. 48759 individuals who did not have low birth weight and had pre-pregnancy folic intake. 13835 individuals who had low birth weight and had pre-pregnancy folic intake.

For pregnancy- 75658 individuals who did not have low birth weight and did not have folic intake during pregnancy. 20846 individuals who had low birth weight and did not have folic intake during pregnancy. 96560 individuals who did not have low birth weight and have folic intake during pregnancy. 24515 individuals who had low birth weight and have folic intake during pregnancy.

```{r}
# For PRE_VIT_RAW vs. LBW
chisq.test(table(data_clean$PRE_VIT_RAW, data_clean$LBW))

# For VPP_VIT_RAW vs. LBW
chisq.test(table(data_clean$VPP_VIT_RAW, data_clean$LBW))
```

Both pre-pregnancy folic intake and folic intake supplementation during pregnancy appear to be significantly associated with low birth weight. These findings suggest that maternal folic intake, either before or during pregnancy, could play an important role in birth weight outcomes.

## Bar Plots {#sec-bar-plots}

### Percentage by LBW

```{r}
data_clean %>%
  filter(!is.na(LBW)) %>%
  group_by(LBW) %>%
  summarise(count = n()) %>%
  mutate(percentage = count / sum(count) * 100) %>%
  ggplot(aes(x = as.factor(LBW), y = percentage, fill = as.factor(LBW))) + 
  geom_bar(stat = "identity", color = "black") +  # Use stat = "identity" for percentages
  scale_fill_manual(
    values = c("0" = "blue", "1" = "red"),  # Assign colors to LBW categories
    labels = c("0" = "No", "1" = "Yes")     # Adjust legend labels
  ) +
  scale_x_discrete(labels = c("0" = "No", "1" = "Yes")) +  # Adjust x-axis labels
  labs(
    title = "Percentage of Low Birth Weight (LBW) Cases",
    x = "Low Birth Weight",
    y = "Percentage",
    fill = "LBW Status"  # Adjust legend title
  ) +
  scale_y_continuous(labels = scales::percent_format(scale = 1)) +  # Format y-axis as percentage
  theme_minimal()  # For cleaner plot appearance
```

In looking at LBW in this population we saw that 78.8% did not have a LBW baby, while 21.2% did.

###Percentage by Pre-pregnancy & During Pregnancy Folic Intake

```{r}
data_clean %>%
  filter(!is.na(PRE_VIT_RAW), !is.na(VPP_VIT_RAW)) %>%
  pivot_longer(
    cols = c(PRE_VIT_RAW, VPP_VIT_RAW), 
    names_to = "Folic_Acid_Stage", 
    values_to = "Folic_Acid_Intake"
  ) %>%
  group_by(Folic_Acid_Stage, Folic_Acid_Intake) %>%
  summarise(count = n(), .groups = "drop") %>%
  group_by(Folic_Acid_Stage) %>%  # Group by Folic_Acid_Stage for percentage calculation
  mutate(percentage = count / sum(count) * 100) %>%  # Compute percentage within each stage
  ggplot(aes(x = as.factor(Folic_Acid_Intake), y = percentage, fill = as.factor(Folic_Acid_Intake))) + 
  geom_bar(stat = "identity", position = "dodge", color = "black") +  # Dodge position for side-by-side bars
  scale_fill_manual(
    values = c("0" = "blue", "1" = "red"),  # Assign colors for No and Yes
    labels = c("0" = "No", "1" = "Yes")     # Adjust legend labels
  ) +
  scale_x_discrete(labels = c("0" = "No", "1" = "Yes")) +  # Adjust x-axis labels
  facet_wrap(
    ~ Folic_Acid_Stage, 
    labeller = labeller(Folic_Acid_Stage = c("PRE_VIT_RAW" = "Pre-Pregnancy Intake", 
                                             "VPP_VIT_RAW" = "Pregnancy Intake"))  # Custom facet labels
  ) +
  labs(
    title = "Percentage of Folic Acid Intake Pre and During Pregnancy",
    x = "Folic Acid Intake",
    y = "Percentage",
    fill = "Folic Acid Intake"  # Legend title
  ) +
  scale_y_continuous(labels = scales::percent_format(scale = 1)) +  # Format y-axis as percentage
  theme_minimal()  # For cleaner plot appearance

```

In looking at pre-pregnancy folic acid intake, we saw that 36.2% of women did take folic acid, while 63.8% did not.

During pregnancy folic acid intake increased with 55.6% of women taking folic acid while 44.4% did not.

### Count of People with Folic Acid Intake (Pre and During Pregnancy Bar Plots)

```{r}
# Combine both Pre and During Pregnancy Folic Acid Intake Counts in One Plot
data_clean %>%
  gather(key = "Pregnancy_Status", value = "Folic_Acid_Intake", PRE_VIT_RAW, VPP_VIT_RAW) %>%
  mutate(Folic_Acid_Intake = factor(Folic_Acid_Intake, levels = c(0, 1), labels = c("No", "Yes"))) %>%
  filter(!is.na(Folic_Acid_Intake)) %>% 
  ggplot(aes(x = Folic_Acid_Intake, fill = Folic_Acid_Intake)) +
  geom_bar() + 
  scale_fill_manual(values = c("blue", "red")) +
  facet_wrap(~ Pregnancy_Status, scales = "free", labeller = labeller(Pregnancy_Status = c("PRE_VIT_RAW" = "Pre-Pregnancy", "VPP_VIT_RAW" = "During Pregnancy"))) +
  labs(x = "Folic Acid Intake", y = "Count of People", fill = "Folic Acid Intake",
       title = "Count of People with Folic Acid Intake (Pre and During Pregnancy)") +
  theme_minimal() +
  theme(legend.position = "top")
```

```{r}
# Count people by folic acid intake status for both pre-pregnancy and during pregnancy
data_clean %>%
  gather(key = "Pregnancy_Status", value = "Folic_Acid_Intake", PRE_VIT_RAW, VPP_VIT_RAW) %>%
  mutate(Folic_Acid_Intake = factor(Folic_Acid_Intake, levels = c(0, 1), labels = c("No", "Yes"))) %>%
  filter(!is.na(Folic_Acid_Intake)) %>%
  count(Pregnancy_Status, Folic_Acid_Intake)
```

A larger proportion of people took folic acid during pregnancy (121,177 people) compared to before pregnancy (62,669 people). Similarly, more people did not take folic acid before pregnancy (110,466 people) than during pregnancy (96,628 people).

### Pre-Pregnancy Folic Acid Intake Bar Plots

```{r}
## barplot of Pre-Pregnancy Folic Acid Intake and LBW Status
ggplot(data_clean %>% filter(!is.na(PRE_VIT_RAW), !is.na(LBW)), aes(x = PRE_VIT_RAW, fill = factor(LBW))) +
  geom_bar(position = "fill") +  # "fill" makes the bars proportional (percentage)
  scale_y_continuous(labels = scales::percent) +
  scale_x_discrete(labels = c("0" = "No", "1" = "Yes")) +  # Change 0, 1 to No, Yes on x-axis
  scale_fill_manual(values = c("0" = "blue", "1" = "red"), labels = c("0" = "No", "1" = "Yes")) +  # Change 0, 1 to No, Yes in the legend
  labs(x = "Pre-Pregnancy Folic Acid Intake", y = "Percentage of Individuals", fill = "LBW Status",
       title = "Pre-Pregnancy Folic Acid Intake and LBW Status") +
  theme_minimal()
```

```{r}
data_clean %>%
  filter(!is.na(PRE_VIT_RAW), !is.na(LBW)) %>%
  count(PRE_VIT_RAW, LBW)
```

Pre-pregnancy: For people with no folic acid intake: 78.8% do not have LBW 21.2% have LBW

For people with folic acid intake: 77.9% do not have LBW 22.1% have LBW

### During Pregnancy Folic Acid Intake Bar Plots

```{r}
## bar plot of During Pregnancy Folic Acid Intake Bar Plots
ggplot(data_clean %>% filter(!is.na(VPP_VIT_RAW), !is.na(LBW)), aes(x = VPP_VIT_RAW, fill = factor(LBW))) +
  geom_bar(position = "fill") +  # "fill" makes the bars proportional (percentage)
  scale_y_continuous(labels = scales::percent) +
  scale_x_discrete(labels = c("0" = "No", "1" = "Yes")) +  # Change 0, 1 to No, Yes on x-axis
  scale_fill_manual(values = c("0" = "blue", "1" = "red"), labels = c("0" = "No", "1" = "Yes")) +  # Change 0, 1 to No, Yes in the legend
  labs(x = "During Pregnancy Folic Acid Intake", y = "Percentage of Individuals", fill = "LBW Status",
       title = "During Pregnancy Folic Acid Intake and LBW Status") +
  theme_minimal()
```

```{r}
data_clean %>%
  filter(!is.na(VPP_VIT_RAW), !is.na(LBW)) %>%
  count(VPP_VIT_RAW, LBW)
```

During pregnancy: For people with no folic acid intake during pregnancy: 78.4% do not have LBW 21.6% have LBW For people with folic acid intake during pregnancy: 79.8% do not have LBW 20.2% have LBW

### Combined Pregnancy Folic Acid Intake Bar Plots

```{r}
data_combined <- data_clean %>%
  filter(!is.na(PRE_VIT_RAW), !is.na(VPP_VIT_RAW), !is.na(LBW)) %>%
  pivot_longer(cols = c(PRE_VIT_RAW, VPP_VIT_RAW), 
               names_to = "Folic_Acid_Stage", 
               values_to = "Folic_Acid_Intake") %>%
  mutate(Folic_Acid_Stage = recode(Folic_Acid_Stage, 
                                   "PRE_VIT_RAW" = "Pre-Pregnancy", 
                                   "VPP_VIT_RAW" = "During Pregnancy"),
         Folic_Acid_Stage = factor(Folic_Acid_Stage, levels = c("Pre-Pregnancy", "During Pregnancy"))) %>%
  group_by(Folic_Acid_Stage, Folic_Acid_Intake, LBW) %>%
  summarise(count = n()) %>%
  ungroup() %>%
  group_by(Folic_Acid_Stage, Folic_Acid_Intake) %>%
  mutate(total = sum(count),
         percentage = count / total * 100) %>%
  ungroup()

# Plotting
ggplot(data_combined, aes(x = factor(Folic_Acid_Intake), y = percentage, fill = factor(LBW))) +
  geom_bar(stat = "identity", position = "dodge", width = 0.7) +  # Use stat = "identity" to plot percentages
  scale_y_continuous(labels = scales::percent_format(scale = 1)) +  # Format y-axis as percentage
  scale_x_discrete(labels = c("0" = "No", "1" = "Yes")) +  # Customize x-axis labels
  scale_fill_manual(values = c("0" = "blue", "1" = "red"), labels = c("0" = "No", "1" = "Yes")) +  # Customize colors
  labs(x = "Folic Acid Intake", y = "Percentage of Individuals", fill = "LBW Status", 
       title = "Folic Acid Intake (Pre and During Pregnancy) and LBW Status") +
  facet_wrap(~ Folic_Acid_Stage) +  # Facet by folic acid intake stage
  theme_minimal()
```

Looking at pre-pregnancy folic acid intake and during pregnancy folic acid intake and LBW status, we saw that for those Pre-pregnancy who didnt take folic acid: 78.8% do not have LBW 21.2% have LBW. and for people with folic acid intake: 77.9% do not have LBW 22.1% have LBW.

For those During pregnancy with no folic acid intake: 78.4% do not have LBW 21.6% have LBW and For people with folic acid intake during pregnancy: 79.8% do not have LBW 20.2% have LBW.

Although the differences in LBW rates between those who took folic acid and those who did not are small for both, this might suggest that taking folic acid during pregnancy may offer a slightly greater protective effect against low birth weight than taking it before pregnancy.

##Covariates by Outcomes

### Parity

```{r}
##bar plot of Parity and LBW Status
ggplot(data_clean %>% filter(!is.na(PRE_LB_NAPHSIS), !is.na(LBW)), aes(x = PRE_LB_NAPHSIS, fill = factor(LBW))) +
  geom_bar(position = "fill") +  # "fill" makes the bars proportional (percentage)
  scale_y_continuous(labels = scales::percent) +
  scale_x_discrete(labels = c("0" = "No children", "1" = "One child", "2" = "2+ children")) +  # Change 0, 1 to No, Yes on x-axis
  scale_fill_manual(values = c("0" = "blue", "1" = "red"), labels = c("0" = "No", "1" = "Yes")) +  # Change 0, 1 to No, Yes in the legend
  labs(x = "Parity", y = "Percentage of Individuals", fill = "LBW Status",
       title = "Parity and LBW Status") +
  theme_minimal()
```

```{r}
data_clean %>%
  filter(!is.na(PRE_LB_NAPHSIS), !is.na(LBW)) %>%
  count(PRE_LB_NAPHSIS, LBW)
```

For PRE_LB_NAPHSIS = 0: 76.2% do not have LBW 23.8% have LBW

For PRE_LB_NAPHSIS = 1: 81.5% do not have LBW 18.5% have LBW

For PRE_LB_NAPHSIS = 2: 79.6% do not have LBW 20.4% have LBW

First-time pregnancies (PRE_LB_NAPHSIS = 0) have the highest LBW risk (23.8%). One prior pregnancy (PRE_LB_NAPHSIS = 1) seems to have the best outcomes with the lowest proportion of LBW (18.5%). These patterns suggest that maternal history of prior pregnancies influences birth weight outcomes, potentially due to biological or healthcare-related factors that improve with experience or repeated exposure to pregnancy.

### Maternal Age

```{r}
## box plot of Maternal Age by LBW Status
data_clean %>% 
  filter(!is.na(MAT_AGE_PU), !is.na(LBW)) %>%
  ggplot(aes(x = factor(LBW, levels = c("0", "1"), labels = c("No", "Yes")), y = MAT_AGE_PU, color = factor(LBW, levels = c("0", "1"), labels = c("No", "Yes")))) +
  geom_boxplot(width = 0.5) +
  geom_jitter(width = 0.1, alpha = 0.3) +
  ggtitle("Maternal Age by LBW Status") +
  xlab("LBW Status") +
  ylab("Maternal Age (Years)") +
  scale_color_manual(name = "LBW Status", values = c("red", "blue")) +
  theme_minimal()  # Use a built-in theme here
```

```{r}
ci_data <- data_clean %>%
  filter(!is.na(MAT_AGE_PU), !is.na(LBW)) %>%
  group_by(LBW) %>%
  summarize(
    Median_Age = median(MAT_AGE_PU),
    IQR_Lower = quantile(MAT_AGE_PU, 0.25),
    IQR_Upper = quantile(MAT_AGE_PU, 0.75)
  )

print(ci_data)
```

For individuals without LBW (LBW group 0), the central value of maternal age is 29 years, with the middle 50% of the ages falling between 25 and 33 years. For individuals with LBW, the median maternal age is also 29 years. However, the range of ages for the middle 50% of individuals is slightly broader, spanning from 25 to 34 years.

### Maternal BMI

```{r}
## box plot of Maternal BMI by LBW Status
data_clean %>% 
  filter(!is.na(MOM_BMI), !is.na(LBW)) %>%
  ggplot(aes(x = factor(LBW, levels = c("0", "1"), labels = c("No", "Yes")), y = MOM_BMI, color = factor(LBW, levels = c("0", "1"), labels = c("No", "Yes")))) +
  geom_boxplot(width = 0.5) +
  geom_jitter(width = 0.1, alpha = 0.3) +
  ggtitle("Maternal BMI by LBW Status") +
  xlab("LBW Status") +
  ylab("Maternal BMI (kg/m2)") +
  scale_color_manual(name = "LBW Status", values = c("red", "blue")) +
  theme_minimal()  # Use a built-in theme here

```

```{r}
ci_data <- data_clean %>%
  filter(!is.na(MOM_BMI), !is.na(LBW)) %>%
  group_by(LBW) %>%
  summarize(
    Median_BMI = median(MOM_BMI),
    IQR_Lower = quantile(MOM_BMI, 0.25),
    IQR_Upper = quantile(MOM_BMI, 0.75)
  )

print(ci_data)
```

For mothers whose babies did not have low birth weight, the middle 50% of BMI range from 22.15 to 30.54 kg/m\^2;, with a median of 25.61 kg/m\^2. For mothers whose babies did have low birth weight, the middle 50% of BMI range from 21.79 to 30.91 kg/m\^2, with a median of 25.51 kg/m\^2.

### Maternal Education

```{r}
## bar plot of Maternal Education and LBW Status
ggplot(data_clean %>% 
         filter(!is.na(MAT_ED), !is.na(LBW)) %>% 
         mutate(MAT_ED = factor(MAT_ED, levels = c("<= 12th grade, no diploma", 
                                                   "High school graduate / GED", 
                                                   "Some college, no degree", 
                                                   "Bachelor's, Master's, or higher"))),
       aes(x = MAT_ED, fill = factor(LBW))) +
  geom_bar(position = "fill") +  # "fill" makes the bars proportional (percentage)
  scale_y_continuous(labels = scales::percent) +
  scale_fill_manual(values = c("0" = "blue", "1" = "red"), labels = c("0" = "No", "1" = "Yes")) +  # Custom colors for LBW
  labs(
    x = "Maternal Education", 
    y = "Percentage of Individuals", 
    fill = "LBW Status", 
    title = "Maternal Education and LBW Status"
  ) +
  theme_minimal() +
  theme(axis.text.x = element_text(angle = 45, hjust = 1))
```

```{r}
data_clean %>%
  filter(!is.na(MAT_ED), !is.na(LBW)) %>%
  count(MAT_ED, LBW)
```

\<= 12th grade, no diploma: No LBW: 77.2% of individuals without a diploma had babies with normal birth weight. LBW: 22.8% of individuals without a diploma had babies with low birth weight.

High school graduate / GED: No LBW: 76.4% of high school graduates had babies with normal birth weight. LBW: 23.6% of high school graduates had babies with low birth weight.

Some college, no degree: No LBW: 78.1% of individuals with some college education had babies with normal birth weight. LBW: 21.9% of individuals with some college education had babies with low birth weight.

Bachelor's, Master's, or higher: No LBW: 81.6% of individuals with higher education had babies with normal birth weight. LBW: 18.4% of individuals with higher education had babies with low birth weight.

Higher maternal education is associated with a lower proportion of low birth weight outcomes.

### Income

```{r}
ggplot(data_clean %>% 
         filter(!is.na(INCOME8), !is.na(LBW)) %>% 
         mutate(INCOME8 = factor(INCOME8, levels = c("Low income (0 - $40,000)", 
                                                     "Middle ($40,001 - $85,000)", 
                                                     "High income ($85,001 or more)"))),
       aes(x = INCOME8, fill = factor(LBW))) +
  geom_bar(position = "fill") +  # "fill" makes the bars proportional (percentage)
  scale_y_continuous(labels = scales::percent) +
  scale_fill_manual(values = c("0" = "blue", "1" = "red"), labels = c("0" = "No", "1" = "Yes")) +  # Change 0, 1 to No, Yes in the legend
  labs(x = "Income", y = "Percentage of Individuals", fill = "LBW Status",
       title = "Income and LBW Status") +
  theme_minimal() +
  theme(axis.text.x = element_text(angle = 45, hjust = 1))
```

```{r}
data_clean %>%
  filter(!is.na(INCOME8), !is.na(LBW)) %>%
  count(INCOME8, LBW)
```

High Income (\$85,001 or more) 82.6% do not have LBW. 17.4% have LBW.

Low Income (\$0 - \$40,000) 76.1% do not have LBW. 23.9% have LBW.

Middle Income (\$40,001 - \$85,000) 80.8% do not have LBW. 19.2% have LBW.

Income level is inversely associated with LBW risk: higher income correlates with lower LBW percentages. The low-income group shows the highest proportion of LBW (23.9%), emphasizing the role of socioeconomic disparities in adverse birth outcomes.

### Number of Prenatal Care

```{r}
## clean data, make numeric
data_clean$PNC_VST <- as.numeric(data_clean$PNC_VST)
## bar plot of Number of Prenatal Care
data_clean %>% 
  filter(!is.na(PNC_VST), !is.na(LBW)) %>%
  ggplot(aes(x = factor(LBW, levels = c("0", "1"), labels = c("No", "Yes")), y = PNC_VST, color = factor(LBW, levels = c("0", "1"), labels = c("No", "Yes")))) +
  geom_boxplot(width = 0.5) +
  geom_jitter(width = 0.1, alpha = 0.3) +
  ggtitle("Number of Prenatal Care by LBW Status") +
  xlab("LBW Status") +
  ylab("Number of Prenatal Care (Count)") +
  scale_color_manual(name = "LBW Status", values = c("red", "blue")) +
  theme_minimal()  # Use a built-in theme here
```

```{r}
data_clean <- data_clean %>%
  mutate(PNC_VST = as.numeric(as.character(PNC_VST)))

ci_data <- data_clean %>%
  filter(!is.na(PNC_VST), !is.na(LBW)) %>%
  group_by(LBW) %>%
  summarize(
    Median_PNC_VST = median(PNC_VST),
    IQR_Lower = quantile(PNC_VST, 0.25),
    IQR_Upper = quantile(PNC_VST, 0.75)
  )

print(ci_data)
```

For mothers whose babies did not have low birth weight, the middle 50% of BMI range from 10 to 13, with a median of 12. For mothers whose babies did have low birth weight, the middle 50% of BMI range from 7 to 12, with a median of 10.

### Maternal Race

```{r}
## bar plot of Maternal Race
ggplot(data_clean %>% filter(!is.na(MAT_RACE_PU), !is.na(LBW)), aes(x = MAT_RACE_PU, fill = factor(LBW))) +
  geom_bar(position = "fill") +  # "fill" makes the bars proportional (percentage)
  scale_y_continuous(labels = scales::percent) +
  scale_x_discrete(labels = c("White" = "White", "Black" = "Black", "American Indian" = "American Indian", "Alaska Native" = "Alaska Native", "Asian" = "Asian", "Hawaiian/Other Pacific Islander" = "Hawaiian/Other Pacific Islander", "Other/Multiple Race" = "Other/Multiple Race")) +  # Change 0, 1 to No, Yes on x-axis
  scale_fill_manual(values = c("0" = "blue", "1" = "red"), labels = c("0" = "No", "1" = "Yes")) +  # Change 0, 1 to No, Yes in the legend
  labs(x = "Maternal Race", y = "Percentage of Individuals", fill = "LBW Status",
       title = "Maternal Race and LBW Status") +
  theme(axis.text.x = element_text(angle = 45, hjust = 1))  # Rotate x-axis labels for readability
```

```{r}
data_clean %>%
  filter(!is.na(MAT_RACE_PU), !is.na(LBW)) %>%
  count(MAT_RACE_PU, LBW)
```

American Indian 91.4% do not have LBW. 8.6% have LBW. Asian 80.8% do not have LBW. 19.2% have LBW. Black 73.9% do not have LBW. 26.1% have LBW. Hawaiian/Other Pacific Islander 85.5% do not have LBW. 14.5% have LBW. Other/Multiple Race 82.1% do not have LBW. 17.9% have LBW. White 78.9% do not have LBW. 21.1% have LBW.

The data suggests that the Black racial group has the highest proportion of LBW cases (26.1%), followed by White (21.1%) and Asian (19.2%) individuals. The American Indian and Hawaiian/Other Pacific Islander groups show the lowest rates of LBW. This disparity highlights the potential need for addressing race-related factors contributing to LBW and suggests the importance of tailored interventions for different racial groups.

## Dot plot of Occurrences of LBW for each state

```{r}
# Summarize the data: Count occurrences of LBW for each state
heatmap_data <- data_clean %>%
  group_by(STATE, LBW) %>%
  summarise(count = n(), .groups = 'drop') %>%
  pivot_wider(names_from = LBW, values_from = count, values_fill = list(count = 0))  # Reshape the data

# Create the dot plot with enhanced color scale
ggplot(heatmap_data, aes(x = STATE, y = factor(`1`), size = `1`, color = `1`)) +  # Use the '1' column for LBW=1
  geom_point(shape = 16, alpha = 0.7) +  # Use dots (size indicates count)
  scale_size_continuous(range = c(3, 10)) +  # Adjust size of dots
  scale_color_viridis_c(option = "inferno", begin = 0.2, end = 1) +  # Use the 'inferno' color palette for better contrast
  labs(title = "Dot Plot of Low Birth Weight by State",
       x = "State", y = "Number of Low Birth Weight (Count)",
       color = "Count", size = "Count") +
  theme_minimal() +
  theme(axis.text.x = element_text(angle = 45, hjust = 1)) +
  theme(legend.position = "bottom")  # Position the legend at the bottom
```

Top 5 Places with Highest LBW Counts: Kansas, Utah, New York City, Puerto Rico, Pennsylvania

Top 5 Places with Highest LBW Counts: Northern Mariana, Indiana, Arizona, Minnesota, North Dakota

## Dot plot of Rates of LBW for each state

```{r}
# Summarize the data: Calculate the LBW rate for each state
heatmap_data <- data_clean %>%
  group_by(STATE, LBW) %>%
  summarise(count = n(), .groups = 'drop') %>%
  pivot_wider(names_from = LBW, values_from = count, values_fill = list(count = 0)) %>%  # Reshape the data
  mutate(rate = `1` / (`0` + `1`))  # Calculate rate of LBW

# Create the dot plot with enhanced color scale using rates
ggplot(heatmap_data, aes(x = STATE, y = rate, size = rate, color = rate)) +  # Use 'rate' column
  geom_point(shape = 16, alpha = 0.7) +  # Use dots (size indicates rate)
  scale_size_continuous(range = c(3, 10)) +  # Adjust size of dots
  scale_color_viridis_c(option = "inferno", begin = 0.2, end = 1) +  # Use 'inferno' color palette for rates
  labs(title = "Dot Plot of Low Birth Weight Rate by State",
       x = "State", y = "Low Birth Weight Rate",
       color = "Rate", size = "Rate") +
  theme_minimal() +
  theme(axis.text.x = element_text(angle = 45, hjust = 1)) +
  theme(legend.position = "bottom")  # Position the legend at the bottom

```

In looking at LBW by states, we saw the Top 5 states with the highest LBW rates—Mississippi (MS), Tennessee (TN), New York (NY), Puerto Rico (PR), and Kansas (KS)—highlight regions where disparities may be more pronounced.

## Logistic Regression {#sec-logistic-regression}

```{r}
# Set reference categories only for categorical variables
data_clean <- data_clean %>%
  mutate(
    PRE_LB_NAPHSIS = relevel( PRE_LB_NAPHSIS, ref = "0"),
    MAT_ED = relevel(MAT_ED, ref = "Bachelor's, Master's, or higher"),  # Set reference for       MAT_ED
    INCOME8 = relevel(INCOME8, ref = "Low income (0 - $40,000)"),  # Set reference for INCOME8
    MAT_RACE_PU = relevel(MAT_RACE_PU, ref = "White")  # Set reference for MAT_RACE_PU (if you want to control this)
  )

```

### Pre-Preg {#sec-logistic-regression-table-pre-preg}

```{r}
# Unadjusted logistic regression for LBW with pre-pregnancy folic acid
logit_prepreg_unadjusted <- glm(
  LBW ~ PRE_VIT_RAW,
  data = data_clean,
  family = binomial()
)

# Adjusted logistic regression for LBW with pre-pregnancy folic acid
logit_prepreg_adjusted <- glm(
  LBW ~ PRE_VIT_RAW + MAT_AGE_PU + MOM_BMI + PRE_LB_NAPHSIS + MAT_ED + STATE + INCOME8 + PNC_VST + MAT_RACE_PU,
  data = data_clean,
  family = binomial()
)

# Display unadjusted and adjusted results for pre-pregnancy folic acid
prepreg_unadjusted_results <- summary(logit_prepreg_unadjusted, exponentiate = TRUE, conf.int = TRUE)
prepreg_adjusted_results <- summary(logit_prepreg_adjusted, exponentiate = TRUE, conf.int = TRUE)

print(prepreg_unadjusted_results)
print(prepreg_adjusted_results)

# Extracting Odds Ratios (ORs) and Confidence Intervals (CIs) for the unadjusted model
prepreg_unadjusted_or <- exp(prepreg_unadjusted_results$coefficients[, "Estimate"])
prepreg_unadjusted_se <- prepreg_unadjusted_results$coefficients[, "Std. Error"]
prepreg_unadjusted_ci <- exp(confint.default(logit_prepreg_unadjusted))

# Extracting Odds Ratios (ORs) and Confidence Intervals (CIs) for the adjusted model
prepreg_adjusted_or <- exp(prepreg_adjusted_results$coefficients[, "Estimate"])
prepreg_adjusted_se <- prepreg_adjusted_results$coefficients[, "Std. Error"]
prepreg_adjusted_ci <- exp(confint.default(logit_prepreg_adjusted))

# Combine ORs and CIs into data frames
prepreg_unadjusted_df <- data.frame(
  OR = prepreg_unadjusted_or,
  CI_lower = prepreg_unadjusted_ci[, 1],
  CI_upper = prepreg_unadjusted_ci[, 2]
)

prepreg_adjusted_df <- data.frame(
  OR = prepreg_adjusted_or,
  CI_lower = prepreg_adjusted_ci[, 1],
  CI_upper = prepreg_adjusted_ci[, 2]
)

# Print results
print(prepreg_unadjusted_df)
print(prepreg_adjusted_df)
```

Pre-pregnancy folic acid intake is associated with higher odds of LBW (OR = 1.056, p-value = 7.29e-06, 95% CI: \[1.031, 1.081\]).

Adjusting for confounders, pre-pregnancy folic acid intake is associated with higher odds of LBW (OR = 1.144, p-value = \< 2e-16, 95% CI: \[1.110, 1.180\]).

### During Preg {#sec-logistic-regression-table-during-preg}

```{r}
# Unadjusted logistic regression for LBW with during-pregnancy folic acid
logit_duringpreg_unadjusted <- glm(
  LBW ~ VPP_VIT_RAW,
  data = data_clean,
  family = binomial()
)

# Adjusted logistic regression for LBW with during-pregnancy folic acid
logit_duringpreg_adjusted <- glm(
  LBW ~ VPP_VIT_RAW + MAT_AGE_PU + MOM_BMI + PRE_LB_NAPHSIS + MAT_ED + STATE + INCOME8 + PNC_VST + MAT_RACE_PU,
  data = data_clean,
  family = binomial()
)

# Display unadjusted and adjusted results for during-pregnancy folic acid
duringpreg_unadjusted_results <- summary(logit_duringpreg_unadjusted, exponentiate = TRUE, conf.int = TRUE)
duringpreg_adjusted_results <- summary(logit_duringpreg_adjusted, exponentiate = TRUE, conf.int = TRUE)

print(duringpreg_unadjusted_results)
print(duringpreg_adjusted_results)

# Extracting Odds Ratios (ORs) and Confidence Intervals (CIs) for the unadjusted model
duringpreg_unadjusted_or <- exp(duringpreg_unadjusted_results$coefficients[, "Estimate"])
duringpreg_unadjusted_se <- duringpreg_unadjusted_results$coefficients[, "Std. Error"]
duringpreg_unadjusted_ci <- exp(confint.default(logit_duringpreg_unadjusted))

# Extracting Odds Ratios (ORs) and Confidence Intervals (CIs) for the adjusted model
duringpreg_adjusted_or <- exp(duringpreg_adjusted_results$coefficients[, "Estimate"])
duringpreg_adjusted_se <- duringpreg_adjusted_results$coefficients[, "Std. Error"]
duringpreg_adjusted_ci <- exp(confint.default(logit_duringpreg_adjusted))

# Combine ORs and CIs into data frames
duringpreg_unadjusted_df <- data.frame(
  OR = duringpreg_unadjusted_or,
  CI_lower = duringpreg_unadjusted_ci[, 1],
  CI_upper = duringpreg_unadjusted_ci[, 2]
)

duringpreg_adjusted_df <- data.frame(
  OR = duringpreg_adjusted_or,
  CI_lower = duringpreg_adjusted_ci[, 1],
  CI_upper = duringpreg_adjusted_ci[, 2]
)

# Print results
print(duringpreg_unadjusted_df)
print(duringpreg_adjusted_df)
```

Pregnancy folic acid intake is associated with lower odds of LBW (OR = 0.9214, p-value = 1.17e-14, 95% CI: \[0.9025, 0.9408\]).

Adjusting for confounders, there was a slight increase in odds but pregnancy folic acid intake is still associated with lower odds of LBW (OR = 0.9603, p-value = \< 2e-16, 95% CI: \[0.9359, 0.9855\]).

## Forrest Plot Logistic Regression Results {#sec-forrest-plot-logistic-regression-results}

```{r}

# Combine unadjusted and adjusted results for PRE_VIT_RAW
prepreg_df <- data.frame(
  Exposure = c("Pre-Pregnancy Folic Usage (Unadj)", "Pre-Pregnancy Folic Usage (Adj)"),
  OR = c(prepreg_unadjusted_or["PRE_VIT_RAW1"], prepreg_adjusted_or["PRE_VIT_RAW1"]),
  CI_lower = c(prepreg_unadjusted_ci["PRE_VIT_RAW1", 1], prepreg_adjusted_ci["PRE_VIT_RAW1", 1]),
  CI_upper = c(prepreg_unadjusted_ci["PRE_VIT_RAW1", 2], prepreg_adjusted_ci["PRE_VIT_RAW1", 2]),
  Model = c("Unadjusted", "Adjusted")
)

# Combine unadjusted and adjusted results for VPP_VIT_RAW
duringpreg_df <- data.frame(
  Exposure = c("Pregnancy Folic Usage (Unadj)", "Pregnancy Folic Usage (Adj)"),
  OR = c(duringpreg_unadjusted_or["VPP_VIT_RAW1"], duringpreg_adjusted_or["VPP_VIT_RAW1"]),
  CI_lower = c(duringpreg_unadjusted_ci["VPP_VIT_RAW1", 1], duringpreg_adjusted_ci["VPP_VIT_RAW1", 1]),
  CI_upper = c(duringpreg_unadjusted_ci["VPP_VIT_RAW1", 2], duringpreg_adjusted_ci["VPP_VIT_RAW1", 2]),
  Model = c("Unadjusted", "Adjusted")
)

# Combine both data frames into one
combined_df <- bind_rows(prepreg_df, duringpreg_df)

```

## Forrest Plot PrePregnancy

```{r}
prepreg_df <- prepreg_df %>%
  mutate(
    Exposure = factor(
      Exposure, 
      levels = c("Pre-Pregnancy Folic Usage (Unadj)", "Pre-Pregnancy Folic Usage (Adj)")
    ),
    Model = factor(Model, levels = c("Unadjusted", "Adjusted"))  # Ensure the desired legend order
  )

# Plot for Pre-Pregnancy Folic Usage
ggplot(prepreg_df, aes(x = Exposure, y = OR, color = Model, group = Exposure)) +
  geom_point(size = 3) +
  geom_errorbar(aes(ymin = CI_lower, ymax = CI_upper), width = 0.2) +
  scale_y_log10() +  # Log scale for better visualization
  labs(
    x = "Exposure Variables",
    y = "Odds Ratio (95% CI)",
    title = "Odds Ratios with 95% Confidence Intervals for Pre-Pregnancy Folic Usage",
    color = "Model Type"  # Legend title
  ) +
  theme_minimal() +
  theme(axis.text.x = element_text(angle = 45, hjust = 1)) +
  scale_color_manual(values = c("Unadjusted" = "blue", "Adjusted" = "red"))  # Manual color mapping

```

## Forrest Plot Pregnancy

```{r}
duringpreg_df <- duringpreg_df %>%
  mutate(
    Exposure = factor(
      Exposure, 
      levels = c("Pregnancy Folic Usage (Unadj)", "Pregnancy Folic Usage (Adj)")
    ),
    Model = factor(Model, levels = c("Unadjusted", "Adjusted"))  # Ensure the desired legend order
  )

# Plot for During Pregnancy Folic Usage
ggplot(duringpreg_df, aes(x = Exposure, y = OR, color = Model, group = Exposure)) +
  geom_point(size = 3) +
  geom_errorbar(aes(ymin = CI_lower, ymax = CI_upper), width = 0.2) +
  scale_y_log10() +  # Log scale for better visualization
  labs(
    x = "Exposure Variables",
    y = "Odds Ratio (95% CI)",
    title = "Odds Ratios with 95% Confidence Intervals for During Pregnancy Folic Usage",
    color = "Model Type"  # Legend title
  ) +
  theme_minimal() +
  theme(axis.text.x = element_text(angle = 45, hjust = 1)) +
  scale_color_manual(values = c("Unadjusted" = "blue", "Adjusted" = "red"))  # Manual color mapping

```

## Forrest Plot Combined Results

```{r}
combined_df <- combined_df %>%
  mutate(
    Exposure = factor(
      Exposure, 
      levels = c(
        "Pre-Pregnancy Folic Usage (Unadj)", 
        "Pre-Pregnancy Folic Usage (Adj)", 
        "Pregnancy Folic Usage (Unadj)", 
        "Pregnancy Folic Usage (Adj)"
      )
    ),
    Model = factor(Model, levels = c("Unadjusted", "Adjusted"))  # Ensure desired legend order
  )

# Plot the Odds Ratios with Confidence Intervals - combined intake
ggplot(combined_df, aes(x = Exposure, y = OR, color = Model, group = Exposure)) +
  geom_point(size = 3) +
  geom_errorbar(aes(ymin = CI_lower, ymax = CI_upper), width = 0.2) +
  scale_y_log10() +  # Log scale for better visualization
  labs(
    x = "Exposure Variables",
    y = "Odds Ratio (95% CI)",
    title = "Odds Ratios with 95% Confidence Intervals for Pre-Pregnancy and Pregnancy Folic Usage",
    color = "Model Type"  # Legend title
  ) +
  theme_minimal() +
  theme(axis.text.x = element_text(angle = 60, hjust = 1)) +
  scale_color_manual(values = c("Unadjusted" = "blue", "Adjusted" = "red"))  # Manual color mapping

```

Pre-pregnancy folic acid intake is associated with higher odds of LBW (OR = 1.056, p-value = 7.29e-06, 95% CI: \[1.031, 1.081\]).

Adjusting for confounders, pre-pregnancy folic acid intake is associated with higher odds of LBW (OR = 1.144, p-value = \< 2e-16, 95% CI: \[1.110, 1.180\]).

Pregnancy folic acid intake is associated with lower odds of LBW (OR = 0.9214, p-value = 1.17e-14, 95% CI: \[0.9025, 0.9408\]).

Adjusting for confounders, there was a slight increase in odds but pregnancy folic acid intake is still associated with lower odds of LBW (OR = 0.96038, p-value = \< 2e-16, 95% CI: \[0.9359, 0.9855\]).

## Limitations
This analysis has several key limitations that should be considered when interpreting the findings. A major concern is the potential for confounding, particularly in the observed higher odds for pre-pregnancy folic acid intake and LBW. Women who take folic acid before pregnancy may have underlying health complications or a history of adverse pregnancy outcomes that motivated supplementation. These conditions, rather than the folic acid intake itself, could increase the likelihood of LBW, confounding the observed relationship. Additionally, social desirability bias may have influenced the results, as participants might have overreported their folic acid use due to its widely recognized health benefits. This bias could lead to an overestimation of the association between folic acid intake and LBW, as some participants may have claimed use without actually adhering to supplementation. Furthermore, the binary yes/no question about folic acid intake fails to capture critical information, such as the frequency, dosage, or timing of supplementation. This limitation reduces the ability to assess whether intake was sufficient to achieve effective outcomes, potentially obscuring more nuanced relationships. Together, these limitations underscore the importance of cautious interpretation and highlight the need for more detailed data collection and rigorous confounder adjustment in future research.

## Conclusion

This study highlights several critical factors that influence LBW outcomes, with a particular focus on maternal folic acid intake, maternal education, socioeconomic status, and race. The analysis suggests that both pre-pregnancy and pregnancy folic acid intake are significantly associated with LBW, although the association with pregnancy folic acid intake appears to be protective (OR = 0.96), while pre-pregnancy intake is linked to a slight increase in the odds of LBW (OR = 1.14). These findings suggest that the timing of folic acid supplementation may play a role in birth weight outcomes, with pregnancy supplementation potentially offering more favorable outcomes.

Socioeconomic factors, including income and maternal education, are also significant contributors to LBW risk. Higher maternal education and income were observed to have lower rates of LBW, emphasizing the importance of addressing socioeconomic disparities in maternal health. The findings further indicate that racial disparities exist, with Black women having the highest proportion of LBW cases (26.1%), followed by White and Asian women, underscoring the need for targeted interventions within different racial groups.

Maternal age, parity, and prenatal care visits were found to influence birth weight outcomes as well. First-time pregnancies were associated with the highest LBW risk, suggesting that a history of prior pregnancies may improve maternal health outcomes. Additionally, more frequent prenatal care visits were linked to better birth weight outcomes, underscoring the importance of adequate prenatal care in reducing LBW risk.

This study also identifies geographical disparities in LBW, with certain states and territories, such as Kansas and Puerto Rico, showing higher LBW counts, potentially reflecting regional variations in healthcare access and maternal health services.

In conclusion, improving maternal health outcomes and reducing LBW rates require a multifaceted approach that includes addressing nutritional, socioeconomic, healthcare access, and racial disparities. The role of folic acid intake, particularly during pregnancy, should be emphasized in maternal health guidelines, and public health interventions should focus on increasing access to prenatal care, promoting education, and addressing the underlying socioeconomic and racial factors that contribute to LBW.

References

1.  Organization WH. International statistical classification of diseases and related health problems, tenth revision, 2nd ed. World Health Organization; 2004.

2.  Jańczewska, I., Wierzba, J., Jańczewska, A., Szczurek-Gierczak, M., & Domżalska-Popadiuk, I. (2023). Prematurity and Low Birth Weight and Their Impact on Childhood Growth Patterns and the Risk of Long-Term Cardiovascular Sequelae. *Children*, *10*(10), Article 10. <https://doi.org/10.3390/children10101599>

3.  Fu, M., Song, W., Yu, G., Yu, Y., & Yang, Q. (2023). Risk factors for length of NICU stay of newborns: A systematic review. *Frontiers in Pediatrics*, *11*, 1121406. <https://doi.org/10.3389/fped.2023.1121406>

4.  Houk, V. N., Oakley, G. P., Erickson, J. D., Mulinare, J., & James, L. M. (n.d.). *Recommendations for the use of folic acid to reduce the number of cases of spina bifida and other neural tube defects*. Retrieved November 12, 2024, from <https://stacks.cdc.gov/view/cdc/7079>

5.  Scholl, T. O., & Johnson, W. G. (2000). Folic acid: Influence on the outcome of pregnancy1234. *The American Journal of Clinical Nutrition*, *71*(5), 1295S-1303S. <https://doi.org/10.1093/ajcn/71.5.1295s>
